
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../delete/">
      
      
        <link rel="next" href="../access_control/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>Search - QuickRest</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6f8fc17f.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#quickrest.mixins.search.SearchConfig" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="QuickRest" class="md-header__button md-logo" aria-label="QuickRest" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            QuickRest
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Search
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/Lkruitwagen/quickrest/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="QuickRest" class="md-nav__button md-logo" aria-label="QuickRest" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    QuickRest
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Lkruitwagen/quickrest/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QuickRest
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../resource/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Resource
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CRUD
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            CRUD
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../read/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../create/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../update/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../delete/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Delete
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Search
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Search
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#quickrest.mixins.search.SearchConfig" class="md-nav__link">
    <span class="md-ellipsis">
      SearchConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quickrest.mixins.search.SearchMixin" class="md-nav__link">
    <span class="md-ellipsis">
      SearchMixin
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SearchMixin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quickrest.mixins.search.SearchMixin--searchmodel" class="md-nav__link">
    <span class="md-ellipsis">
      SearchModel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quickrest.mixins.search.SearchMixin--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quickrest.mixins.search.SearchMixin--endpoint-search-resource" class="md-nav__link">
    <span class="md-ellipsis">
      Endpoint - Search Resource
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../access_control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fine-Grained Access Control
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#quickrest.mixins.search.SearchConfig" class="md-nav__link">
    <span class="md-ellipsis">
      SearchConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quickrest.mixins.search.SearchMixin" class="md-nav__link">
    <span class="md-ellipsis">
      SearchMixin
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SearchMixin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quickrest.mixins.search.SearchMixin--searchmodel" class="md-nav__link">
    <span class="md-ellipsis">
      SearchModel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quickrest.mixins.search.SearchMixin--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quickrest.mixins.search.SearchMixin--endpoint-search-resource" class="md-nav__link">
    <span class="md-ellipsis">
      Endpoint - Search Resource
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Search</h1>

<div class="doc doc-object doc-class">



<h2 id="quickrest.mixins.search.SearchConfig" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>SearchConfig</code>


</h2>


    <div class="doc doc-contents first">


        <p>The <code>SearchConfig</code> class can optionally be defined on the resource class.
The search route is used for searching for retrieving multiple resource objects
and is exposed as a GET endpoint on the bare resource path <code>/{resource_name}</code>.
This class should inherit from <code>SearchConfig</code> and must be called <code>search_cfg</code>.
If <code>search_cfg</code> is set to <code>None</code>, then the search route isn't created.</p>
<p><code>SearchConfig</code> has router-defining attributes that can be set to configure the search route,
including a description, summary, operation_id, and tag labels.
The <code>dependencies</code> attribute can be set to a list of FastAPI dependencies that will be injected into the search route.</p>
<p><code>SearchConfig</code> also exposes powerful configuration options for filtering and searching for resources.
The <code>search_eq</code> (equals), <code>search_gt</code> (greater-than), <code>search_gte</code> (greater-than-or-equal-to), <code>search_lt</code> (less-than),
and <code>search_lte</code> (less-than-or-equal-to) attributes can be set to filter on numeric fields (int, float, date, datetime).
These parameters can be provided with either a list of field names (<code>list[str]</code>) that will expose these fields in the search query,
or a boolean value that will expose these fields in the search query for all numeric fields.</p>
<p>For string fields, the <code>search_contains</code> attribute can be set to filter on string fields that contain a substring.
The <code>search_similarity</code> attribute can be set to filter on string fields that are similar to a given string.
As with numeric fields, these parameters can be set to either a list of field names (<code>list[str]</code>) or a boolean
value that will expose all string fields in the search query.
If both <code>search_contains</code> and <code>search_similarity</code> are set on a field, the response will include objects that match either condition.</p>
<p>The <code>search_similarity_threshold</code> attribute can be set to specify the similarity threshold for the search.
QuickRest supports both sqlite and postgresql databases for similarity search.
For sqlite, the <code>editdist3</code> function is used to calculate the levenshtein distance between two strings, where string insertions and deletions incur a cost of 100,
and string subsitituitons incur a cost of 150.
The <code>search_similarity_threshold</code> should be set to the <em>maximum</em> distance allowed, and is given a default value of 300 if not set.
The <a href="https://www.sqlite.org/spellfix1.html">Spellfix</a> extension must be enabled in sqlite to use this feature.
For postgresql, the <code>similarity</code> function is used to calculate the similarity between two strings, where a value of 1.0 indicates a perfect match.
Similarity is calculated using the trigram index, which breaks strings into three-letter sequences and compares the sequences between two strings
(a more powerful and versitile similarity measure than levenshtein distance).
The <code>search_similarity_threshold</code> should be set to the <em>minimum</em> similarity allowed, and is given a default value of 0.7 if not set.
The <a href="https://www.postgresql.org/docs/9.1/pgtrgm.html">pg_trgm</a> extension must be enabled in postgresql to use this feature.</p>
<p>Finally, the <code>results_limit</code> attribute can be set to specify the maximum number of results to return in a single search query, defaulting to 10.
The route will also add a <code>page</code> parameter to the query, which can be used to paginate the results.</p>
<p>See the example below for a demonstration of how to use the <code>SearchConfig</code> class.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="quickrest.mixins.search.SearchConfig.description">description</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Description of the endpoint. Optional, defaults to <code>None</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="quickrest.mixins.search.SearchConfig.summary">summary</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Summary of the endpoint. Optional, defaults to <code>get {resource_name}</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="quickrest.mixins.search.SearchConfig.operation_id">operation_id</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Operation ID of the endpoint. Optional, defaults to <code>None</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="quickrest.mixins.search.SearchConfig.tags">tags</span></code></td>
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tags for the endpoint. Optional, defaults to <code>None</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="quickrest.mixins.search.SearchConfig.dependencies">dependencies</span></code></td>
            <td>
                  <code>list[<span title="typing.Callable">Callable</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Injectable callable dependencies for the endpoint. Optional, defaults to <code>[]</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="quickrest.mixins.search.SearchConfig.required_params">required_params</span></code></td>
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of fields that are required in the search query. Optional, defaults to <code>[]</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="quickrest.mixins.search.SearchConfig.pop_params">pop_params</span></code></td>
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of fields that are excluded from the search query. Optional, defaults to <code>[]</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="quickrest.mixins.search.SearchConfig.results_limit">results_limit</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of results to return in a single search query. Optional, defaults to <code>10</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="quickrest.mixins.search.SearchConfig.search_eq">search_eq</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[list[str], bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of fields to filter on exact match, or boolean to apply to all numeric fields. Optional, defaults to <code>None</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="quickrest.mixins.search.SearchConfig.search_gt">search_gt</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[list[str], bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of fields to filter on greater than, or boolean to apply to all numeric fields. Optional, defaults to <code>None</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="quickrest.mixins.search.SearchConfig.search_gte">search_gte</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[list[str], bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of fields to filter on greater than or equal to, or boolean to apply to all numeric fields. Optional, defaults to <code>None</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="quickrest.mixins.search.SearchConfig.search_lt">search_lt</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[list[str], bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of fields to filter on less than, or boolean to apply to all numeric fields. Optional, defaults to <code>None</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="quickrest.mixins.search.SearchConfig.search_lte">search_lte</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[list[str], bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of fields to filter on less than or equal to, or boolean to apply to all numeric fields. Optional, defaults to <code>None</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="quickrest.mixins.search.SearchConfig.search_contains">search_contains</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[list[str], bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of fields to filter on contains, or boolean to apply to all string fields. Optional, defaults to <code>None</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="quickrest.mixins.search.SearchConfig.search_similarity">search_similarity</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[list[str], bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of fields to filter on similarity, or boolean to apply to all string fields. Optional, defaults to <code>None</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="quickrest.mixins.search.SearchConfig.search_similarity_threshold">search_similarity_threshold</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[int, float]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Similarity threshold for the search. Optional, defaults to <code>300</code> for sqlite or <code>0.7</code> for postgres.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>quickrest/mixins/search.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span>
<span class="normal">99</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SearchConfig</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The `SearchConfig` class can optionally be defined on the resource class.</span>
<span class="sd">    The search route is used for searching for retrieving multiple resource objects</span>
<span class="sd">    and is exposed as a GET endpoint on the bare resource path `/{resource_name}`.</span>
<span class="sd">    This class should inherit from `SearchConfig` and must be called `search_cfg`.</span>
<span class="sd">    If `search_cfg` is set to `None`, then the search route isn&#39;t created.</span>

<span class="sd">    `SearchConfig` has router-defining attributes that can be set to configure the search route,</span>
<span class="sd">    including a description, summary, operation_id, and tag labels.</span>
<span class="sd">    The `dependencies` attribute can be set to a list of FastAPI dependencies that will be injected into the search route.</span>

<span class="sd">    `SearchConfig` also exposes powerful configuration options for filtering and searching for resources.</span>
<span class="sd">    The `search_eq` (equals), `search_gt` (greater-than), `search_gte` (greater-than-or-equal-to), `search_lt` (less-than),</span>
<span class="sd">    and `search_lte` (less-than-or-equal-to) attributes can be set to filter on numeric fields (int, float, date, datetime).</span>
<span class="sd">    These parameters can be provided with either a list of field names (`list[str]`) that will expose these fields in the search query,</span>
<span class="sd">    or a boolean value that will expose these fields in the search query for all numeric fields.</span>

<span class="sd">    For string fields, the `search_contains` attribute can be set to filter on string fields that contain a substring.</span>
<span class="sd">    The `search_similarity` attribute can be set to filter on string fields that are similar to a given string.</span>
<span class="sd">    As with numeric fields, these parameters can be set to either a list of field names (`list[str]`) or a boolean</span>
<span class="sd">    value that will expose all string fields in the search query.</span>
<span class="sd">    If both `search_contains` and `search_similarity` are set on a field, the response will include objects that match either condition.</span>

<span class="sd">    The `search_similarity_threshold` attribute can be set to specify the similarity threshold for the search.</span>
<span class="sd">    QuickRest supports both sqlite and postgresql databases for similarity search.</span>
<span class="sd">    For sqlite, the `editdist3` function is used to calculate the levenshtein distance between two strings, where string insertions and deletions incur a cost of 100,</span>
<span class="sd">    and string subsitituitons incur a cost of 150.</span>
<span class="sd">    The `search_similarity_threshold` should be set to the *maximum* distance allowed, and is given a default value of 300 if not set.</span>
<span class="sd">    The [Spellfix](https://www.sqlite.org/spellfix1.html) extension must be enabled in sqlite to use this feature.</span>
<span class="sd">    For postgresql, the `similarity` function is used to calculate the similarity between two strings, where a value of 1.0 indicates a perfect match.</span>
<span class="sd">    Similarity is calculated using the trigram index, which breaks strings into three-letter sequences and compares the sequences between two strings</span>
<span class="sd">    (a more powerful and versitile similarity measure than levenshtein distance).</span>
<span class="sd">    The `search_similarity_threshold` should be set to the *minimum* similarity allowed, and is given a default value of 0.7 if not set.</span>
<span class="sd">    The [pg_trgm](https://www.postgresql.org/docs/9.1/pgtrgm.html) extension must be enabled in postgresql to use this feature.</span>

<span class="sd">    Finally, the `results_limit` attribute can be set to specify the maximum number of results to return in a single search query, defaulting to 10.</span>
<span class="sd">    The route will also add a `page` parameter to the query, which can be used to paginate the results.</span>

<span class="sd">    See the example below for a demonstration of how to use the `SearchConfig` class.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        description (str, optional): Description of the endpoint. Optional, defaults to `None`.</span>
<span class="sd">        summary (str, optional): Summary of the endpoint. Optional, defaults to `get {resource_name}`.</span>
<span class="sd">        operation_id (str, optional): Operation ID of the endpoint. Optional, defaults to `None`.</span>
<span class="sd">        tags (list[str], optional): Tags for the endpoint. Optional, defaults to `None`.</span>
<span class="sd">        dependencies (list[Callable]): Injectable callable dependencies for the endpoint. Optional, defaults to `[]`.</span>
<span class="sd">        required_params (list[str]): List of fields that are required in the search query. Optional, defaults to `[]`.</span>
<span class="sd">        pop_params (list[str]): List of fields that are excluded from the search query. Optional, defaults to `[]`.</span>
<span class="sd">        results_limit (int): Maximum number of results to return in a single search query. Optional, defaults to `10`.</span>
<span class="sd">        search_eq (Union[list[str], bool]): List of fields to filter on exact match, or boolean to apply to all numeric fields. Optional, defaults to `None`.</span>
<span class="sd">        search_gt (Union[list[str], bool]): List of fields to filter on greater than, or boolean to apply to all numeric fields. Optional, defaults to `None`.</span>
<span class="sd">        search_gte (Union[list[str], bool]): List of fields to filter on greater than or equal to, or boolean to apply to all numeric fields. Optional, defaults to `None`.</span>
<span class="sd">        search_lt (Union[list[str], bool]): List of fields to filter on less than, or boolean to apply to all numeric fields. Optional, defaults to `None`.</span>
<span class="sd">        search_lte (Union[list[str], bool]): List of fields to filter on less than or equal to, or boolean to apply to all numeric fields. Optional, defaults to `None`.</span>
<span class="sd">        search_contains (Union[list[str], bool]): List of fields to filter on contains, or boolean to apply to all string fields. Optional, defaults to `None`.</span>
<span class="sd">        search_similarity (Union[list[str], bool]): List of fields to filter on similarity, or boolean to apply to all string fields. Optional, defaults to `None`.</span>
<span class="sd">        search_similarity_threshold (Union[int, float]): Similarity threshold for the search. Optional, defaults to `300` for sqlite or `0.7` for postgres.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">required_params</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">pop_params</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">results_limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="c1"># for float, int, datetime:</span>
    <span class="n">search_eq</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">search_gt</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">search_gte</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">search_lt</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">search_lte</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># for str:</span>
    <span class="n">search_contains</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">search_similarity</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">search_similarity_threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># router method</span>
    <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">summary</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">operation_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">tags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">dependencies</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="quickrest.mixins.search.SearchMixin" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>SearchMixin</code>


</h2>


    <div class="doc doc-contents first">


        <p>This mixin is automatically inherited by the <code>Resource</code> class and provides endpoints for searching for resources.
The mixin also builds a Pydantic model for the input query of the search endpoint.</p>
<h4 id="quickrest.mixins.search.SearchMixin--searchmodel">SearchModel</h4>
<p>The <code>SearchModel</code> is a Pydantic model build using the fields of the sqlalchemy model.
The model parameters are exposed as query parameters, so fastAPI automatically exposes them as query parameters on the route.
The route is exposed directly on the resource root path <code>/{resource_name}</code> and accepts a GET method.
The model may include a <code>slug</code> field if it has been specified on the Resource mixin, or the <code>id</code> field if it is a string.</p>
<h4 id="quickrest.mixins.search.SearchMixin--example">Example:</h4>
<p>This example shows a typical use case - filtering and searching for an 'employees' resource by business_group, name, start_date, and vaccation_days_taken.
In this example, the <code>business_group</code> parameter is required, and the <code>secret_nickname</code> parameter is excluded from the search query.
The construction of these query parameters is described above in the <a href=""><code>SearchConfig</code></a> class.</p>
<p>Note that the <code>SearchEmployee</code> model isn't actually used as a request body schema, but fields are converted to url query parameters, e.g.</p>
<pre><code>GET /exmployees?business_group=HR&amp;name=jessicaish&amp;start_date_gte=2021-01-01&amp;vaccation_days_taken_lt=10&amp;limit=5
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="quickrest.mixins.search.SearchMixin--__tabbed_1_1" name="quickrest.mixins.search.SearchMixin--__tabbed_1" type="radio" /><input id="quickrest.mixins.search.SearchMixin--__tabbed_1_2" name="quickrest.mixins.search.SearchMixin--__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="quickrest.mixins.search.SearchMixin--__tabbed_1_1">SQLAlchemy Resource</label><label for="quickrest.mixins.search.SearchMixin--__tabbed_1_2">Generated query model</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy.orm</span><span class="w"> </span><span class="kn">import</span> <span class="n">Mapped</span><span class="p">,</span> <span class="n">mapped_column</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">quickrest</span><span class="w"> </span><span class="kn">import</span> <span class="n">Base</span><span class="p">,</span> <span class="n">Resource</span><span class="p">,</span> <span class="n">SearchConfig</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">some_package.auth</span><span class="w"> </span><span class="kn">import</span> <span class="n">admin_user</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Employee</span><span class="p">(</span><span class="n">Base</span><span class="p">,</span> <span class="n">Resource</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;employees&quot;</span>

    <span class="n">business_group</span><span class="p">:</span> <span class="n">Mapped</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">mapped_column</span><span class="p">()</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">Mapped</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">mapped_column</span><span class="p">()</span>
    <span class="n">secret_nickname</span><span class="p">:</span> <span class="n">Mapped</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">mapped_column</span><span class="p">()</span>
    <span class="n">start_date</span><span class="p">:</span> <span class="n">Mapped</span><span class="p">[</span><span class="n">date</span><span class="p">]</span> <span class="o">=</span> <span class="n">mapped_column</span><span class="p">()</span>
    <span class="n">vaccation_days_taken</span><span class="p">:</span> <span class="n">Mapped</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">mapped_column</span><span class="p">()</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">search_cfg</span><span class="p">(</span><span class="n">SearchConfig</span><span class="p">):</span>
        <span class="c1"># search filters</span>
        <span class="n">search_gte</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># applies to all numeric fields</span>
        <span class="n">search_lt</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># applies to all numeric fields</span>
        <span class="n">search_contains</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
        <span class="n">search_similarity</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
        <span class="n">search_similarity_threshold</span> <span class="o">=</span> <span class="mi">500</span>

        <span class="n">required_params</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;business_group&quot;</span><span class="p">]</span>  <span class="c1"># require business_group in search</span>
        <span class="n">pop_params</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;secret_nickname&quot;</span><span class="p">]</span>  <span class="c1"># exclude secret_nickname from search</span>

        <span class="c1"># route params</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;search for employees&quot;</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="s2">&quot;search for employees&quot;</span>
        <span class="n">operation_id</span> <span class="o">=</span> <span class="s2">&quot;search_employees&quot;</span>
        <span class="n">tags</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;employees&quot;</span><span class="p">]</span>
        <span class="n">dependencies</span> <span class="o">=</span> <span class="p">[</span><span class="n">admin_user</span><span class="p">]</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span>


<span class="k">class</span><span class="w"> </span><span class="nc">SearchEmployee</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>

    <span class="c1"># string fields</span>
    <span class="n">business_group</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># required, must be exact match</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>  <span class="c1"># not required, and can be used for contains or similarity</span>

    <span class="c1"># numeric fields</span>
    <span class="n">start_date_gte</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">date</span><span class="p">]</span>
    <span class="n">start_date_lt</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">date</span><span class="p">]</span>
    <span class="n">vaccation_days_taken_gte</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="n">vaccation_days_taken_lt</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>

    <span class="c1"># pagination fields</span>
    <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">page</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div>
</div>
</div>
</div>
<h4 id="quickrest.mixins.search.SearchMixin--endpoint-search-resource">Endpoint - Search Resource</h4>
<p>The generated endpoint is a GET request to the resource root path <code>/{resource_name}</code>.</p>
<pre><code>GET /{resource_name}?{query_params}
</code></pre>
<table>
<thead>
<tr>
<th style="text-align: left;">Property</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Method</td>
<td style="text-align: left;"><code>GET</code></td>
</tr>
<tr>
<td style="text-align: left;">Route</td>
<td style="text-align: left;"><code>/{resource_name}</code></td>
</tr>
<tr>
<td style="text-align: left;">Request</td>
<td style="text-align: left;">Path: <code>&lt;none&gt;</code> </br> Query: Resource SearchModel </br> Body: <code>&lt;none&gt;</code></td>
</tr>
<tr>
<td style="text-align: left;">Success Response</td>
<td style="text-align: left;">200 OK: Resource <a href="../resource/#quickrest.mixins.resource.ResourceMixin._build_basemodel">PaginatedBaseModel</a></td>
</tr>
</tbody>
</table>






              <details class="quote">
                <summary>Source code in <code>quickrest/mixins/search.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SearchMixin</span><span class="p">(</span><span class="n">BaseMixin</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This mixin is automatically inherited by the `Resource` class and provides endpoints for searching for resources.</span>
<span class="sd">    The mixin also builds a Pydantic model for the input query of the search endpoint.</span>

<span class="sd">    ## SearchModel</span>

<span class="sd">    The `SearchModel` is a Pydantic model build using the fields of the sqlalchemy model.</span>
<span class="sd">    The model parameters are exposed as query parameters, so fastAPI automatically exposes them as query parameters on the route.</span>
<span class="sd">    The route is exposed directly on the resource root path `/{resource_name}` and accepts a GET method.</span>
<span class="sd">    The model may include a `slug` field if it has been specified on the Resource mixin, or the `id` field if it is a string.</span>

<span class="sd">    ## Example:</span>

<span class="sd">    This example shows a typical use case - filtering and searching for an &#39;employees&#39; resource by business_group, name, start_date, and vaccation_days_taken.</span>
<span class="sd">    In this example, the `business_group` parameter is required, and the `secret_nickname` parameter is excluded from the search query.</span>
<span class="sd">    The construction of these query parameters is described above in the [`SearchConfig`]() class.</span>

<span class="sd">    Note that the `SearchEmployee` model isn&#39;t actually used as a request body schema, but fields are converted to url query parameters, e.g.</span>

<span class="sd">        GET /exmployees?business_group=HR&amp;name=jessicaish&amp;start_date_gte=2021-01-01&amp;vaccation_days_taken_lt=10&amp;limit=5</span>

<span class="sd">    === &quot;SQLAlchemy Resource&quot;</span>

<span class="sd">        ```python</span>
<span class="sd">        from sqlalchemy.orm import Mapped, mapped_column</span>

<span class="sd">        from quickrest import Base, Resource, SearchConfig</span>

<span class="sd">        from some_package.auth import admin_user</span>


<span class="sd">        class Employee(Base, Resource):</span>
<span class="sd">            __tablename__ = &quot;employees&quot;</span>

<span class="sd">            business_group: Mapped[str] = mapped_column()</span>
<span class="sd">            name: Mapped[str] = mapped_column()</span>
<span class="sd">            secret_nickname: Mapped[str] = mapped_column()</span>
<span class="sd">            start_date: Mapped[date] = mapped_column()</span>
<span class="sd">            vaccation_days_taken: Mapped[int] = mapped_column()</span>

<span class="sd">            class search_cfg(SearchConfig):</span>
<span class="sd">                # search filters</span>
<span class="sd">                search_gte = True  # applies to all numeric fields</span>
<span class="sd">                search_lt = True  # applies to all numeric fields</span>
<span class="sd">                search_contains = [&quot;name&quot;]</span>
<span class="sd">                search_similarity = [&quot;name&quot;]</span>
<span class="sd">                search_similarity_threshold = 500</span>

<span class="sd">                required_params = [&quot;business_group&quot;]  # require business_group in search</span>
<span class="sd">                pop_params = [&quot;secret_nickname&quot;]  # exclude secret_nickname from search</span>

<span class="sd">                # route params</span>
<span class="sd">                description = &quot;search for employees&quot;</span>
<span class="sd">                summary = &quot;search for employees&quot;</span>
<span class="sd">                operation_id = &quot;search_employees&quot;</span>
<span class="sd">                tags = [&quot;employees&quot;]</span>
<span class="sd">                dependencies = [admin_user]</span>
<span class="sd">        ```</span>

<span class="sd">    === &quot;Generated query model&quot;</span>

<span class="sd">        ```python</span>
<span class="sd">        from pydantic import BaseModel</span>


<span class="sd">        class SearchEmployee(BaseModel):</span>

<span class="sd">            # string fields</span>
<span class="sd">            business_group: str  # required, must be exact match</span>
<span class="sd">            name: Optional[str]  # not required, and can be used for contains or similarity</span>

<span class="sd">            # numeric fields</span>
<span class="sd">            start_date_gte: Optional[date]</span>
<span class="sd">            start_date_lt: Optional[date]</span>
<span class="sd">            vaccation_days_taken_gte: Optional[int]</span>
<span class="sd">            vaccation_days_taken_lt: Optional[int]</span>

<span class="sd">            # pagination fields</span>
<span class="sd">            limit: int = 10</span>
<span class="sd">            page: int = 0</span>
<span class="sd">        ```</span>

<span class="sd">    ## Endpoint - Search Resource</span>

<span class="sd">    The generated endpoint is a GET request to the resource root path `/{resource_name}`.</span>

<span class="sd">        GET /{resource_name}?{query_params}</span>

<span class="sd">    | Property | Description |</span>
<span class="sd">    | :--- | :---- |</span>
<span class="sd">    | Method | `GET` |</span>
<span class="sd">    | Route | `/{resource_name}` |</span>
<span class="sd">    | Request  | Path: `&lt;none&gt;` &lt;/br&gt; Query: Resource SearchModel &lt;/br&gt; Body: `&lt;none&gt;`|</span>
<span class="sd">    | Success Response | 200 OK: Resource [PaginatedBaseModel](resource.md#quickrest.mixins.resource.ResourceMixin._build_basemodel) |</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_search</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">search_cfg</span><span class="p">(</span><span class="n">SearchConfig</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@classproperty</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">search</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_search</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_search</span> <span class="o">=</span> <span class="n">SearchFactory</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_search</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
    
  </body>
</html>